package ru.rimus.jpcompose3

import androidx.lifecycle.ViewModel
import androidx.lifecycle.viewModelScope
import kotlinx.coroutines.flow.MutableStateFlow
import kotlinx.coroutines.flow.StateFlow
import kotlinx.coroutines.flow.asStateFlow
import kotlinx.coroutines.launch

// Модель данных для элемента списка
data class WordItem(
    val id: Int,
    val word: String,
    val isChecked: Boolean = false,
    val description: String,
    val category: String
)

class WordsViewModel : ViewModel() {

    // Список случайных слов с их описаниями
    private val _wordsList = MutableStateFlow(
        List(50) { index ->
            val randomWords = listOf(
                "Кот", "Собака", "Дом", "Машина", "Книга",
                "Телефон", "Компьютер", "Море", "Гора", "Лес",
                "Река", "Город", "Дерево", "Цветок", "Солнце",
                "Луна", "Звезда", "Облако", "Ветер", "Дождь",
                "Снег", "Огонь", "Вода", "Земля", "Воздух",
                "Время", "Путь", "Мысль", "Идея", "Мечта",
                "Радость", "Грусть", "Любовь", "Дружба", "Семья",
                "Работа", "Отдых", "Путешествие", "Еда", "Напиток",
                "Музыка", "Фильм", "Игра", "Спорт", "Наука",
                "Искусство", "История", "Будущее", "Жизнь", "Мир"
            )

            val descriptions = mapOf(
                "Кот" to "Домашнее животное, любитель спать и ловить мышей",
                "Собака" to "Лучший друг человека, преданное животное",
                "Дом" to "Место, где живет семья, уют и тепло",
                "Машина" to "Транспортное средство для быстрого передвижения",
                "Книга" to "Источник знаний и увлекательных историй",
                "Море" to "Бескрайний водоем с соленой водой",
                "Гора" to "Величественное природное возвышение",
                "Лес" to "Дом для множества растений и животных",
                "Река" to "Поток воды, текущий к морю или озеру",
                "Город" to "Крупный населенный пункт с развитой инфраструктурой",
                "Дерево" to "Многолетнее растение с твердым стволом",
                "Цветок" to "Красивое растение с яркими лепестками",
                "Солнце" to "Звезда, дающая свет и тепло",
                "Луна" to "Спутник Земли, видимый ночью",
                "Звезда" to "Светящееся небесное тело",
                "Облако" to "Скопление водяного пара в небе",
                "Ветер" to "Движение воздуха в атмосфере",
                "Дождь" to "Атмосферные осадки в виде капель воды",
                "Снег" to "Зимние осадки из ледяных кристаллов",
                "Огонь" to "Яркое свечение от горения материала",
                "Вода" to "Жидкость, необходимая для жизни",
                "Земля" to "Планета и поверхность, по которой мы ходим",
                "Воздух" to "Смесь газов, необходимая для дыхания",
                "Время" to "Необратимый поток событий",
                "Путь" to "Направление движения или жизненный маршрут",
                "Мысль" to "Продукт деятельности разума",
                "Идея" to "Творческая концепция или замысел",
                "Мечта" to "Заветное желание, цель",
                "Радость" to "Положительная эмоция, счастье",
                "Грусть" to "Состояние печали, легкой меланхолии",
                "Любовь" to "Глубокое чувство привязанности",
                "Дружба" to "Взаимная привязанность и доверие между людьми",
                "Семья" to "Близкие родственники, живущие вместе",
                "Работа" to "Деятельность, приносящая доход",
                "Отдых" to "Время для восстановления сил",
                "Путешествие" to "Поездка по новым местам",
                "Еда" to "Пища, необходимая для жизни",
                "Напиток" to "Жидкость для утоления жажды",
                "Музыка" to "Искусство звуков и ритма",
                "Фильм" to "Кинематографическое произведение",
                "Игра" to "Развлечение по определенным правилам",
                "Спорт" to "Физическая активность для здоровья",
                "Наука" to "Систематизированное знание о мире",
                "Искусство" to "Творческое отражение действительности",
                "История" to "Наука о прошлом человечества",
                "Будущее" to "Время, которое еще наступит",
                "Жизнь" to "Период существования живого организма",
                "Мир" to "Вся планета и отсутствие войны"
            )

            val categories = listOf("Природа", "Животные", "Абстрактное", "Объекты", "Явления")
            val word = randomWords[index % randomWords.size]

            WordItem(
                id = index,
                word = word,
                description = descriptions[word] ?: "Интересное слово",
                category = categories[index % categories.size]
            )
        }
    )

    val wordsList: StateFlow<List<WordItem>> = _wordsList.asStateFlow()

    // Состояние чекбоксов сохраняется в самом WordItem через isChecked

    fun toggleCheckbox(id: Int) {
        viewModelScope.launch {
            _wordsList.value = _wordsList.value.map { item ->
                if (item.id == id) {
                    item.copy(isChecked = !item.isChecked)
                } else {
                    item
                }
            }
        }
    }

    fun getWordById(id: Int): WordItem? {
        return _wordsList.value.find { it.id == id }
    }

    fun getSelectedWordsCount(): Int {
        return _wordsList.value.count { it.isChecked }
    }
}
